///// LIVE PLOTTINGGGG!
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

initialize() {
initializeMutationType("m1", 0.5, "f", 0.0); // deleterious
initializeGenomicElementType("g1", m1, 1.0);
initializeGenomicElement(g1, 0, 99999);
initializeRecombinationRate(1e-8);
// Use the mutation rate map to vary functional density
ends = c(20000, 40000, 60000, 80000, 99999); /////////////ends for each mutation rate
densities = c(1e-9, 2e-8, 1e-9, 5e-8, 1e-9); ///////////////the actual mutation rate
initializeMutationRate(densities, ends);
}







/////Just a vanilla neutral model setup, nothing surprising. Next is the generation 1 setup:
1 {
	
sim.addSubpop("p1", 5000);
deleteFile("mutations.txt");
}


10000 late() {
	
MUTATIONS=sortBy(unique(sim.subpopulations.individuals.genomes.mutations),"position");

LINE=paste(MUTATIONS.position,"\t");
writeFile("mutations.txt",LINE,append=T);
}


